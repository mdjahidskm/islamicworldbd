<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"></script>
<style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
    .question { background: #fff; padding: 15px; margin: 10px 0; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    input { width: 80%; padding: 6px; margin: 6px 0; border-radius: 6px; border: 1px solid #ccc; }
    button { padding: 6px 12px; background: #198754; color: #fff; border: none; border-radius: 6px; cursor: pointer; }
    button:hover { background: #146c43; }
    h2 { color: #198754; }
</style>
</head>
<body>

<h2>Admin Panel – প্রশ্নের উত্তর দিন</h2>
<div id="questionsList"></div>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyDZU9TtNXcpWW_jp366Kf2eWaN8QjigVeU",
    authDomain: "islamicworldskm.firebaseapp.com",
    projectId: "islamicworldskm",
    storageBucket: "islamicworldskm.appspot.com",
    messagingSenderId: "703538391992",
    appId: "1:703538391992:web:9a36ea8c6f190fb3be3d4d"
  };

  // Initialize Firebase
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const questionsRef = db.collection("questions");

  // সব প্রশ্ন দেখানো (Live update)
  questionsRef.orderBy("timestamp","desc").onSnapshot(snapshot => {
    const list = document.getElementById("questionsList");
    list.innerHTML = "";
    snapshot.forEach(doc => {
      const data = doc.data();
      const div = document.createElement("div");
      div.className = "question";
      div.innerHTML = `
        <b>${data.name}</b>: ${data.questionText}<br>
        <input type="text" placeholder="উত্তর লিখুন" id="answer-${doc.id}" value="${data.answer || ''}">
        <button onclick="submitAnswer('${doc.id}')">উত্তর সংরক্ষণ করুন</button>
        <p><small>${data.answer ? "বর্তমান উত্তর: "+data.answer : "উত্তর এখনও দেওয়া হয়নি"}</small></p>
      `;
      list.appendChild(div);
    });
  });

  // উত্তর সংরক্ষণ করা
  function submitAnswer(docId) {
    const answerText = document.getElementById(`answer-${docId}`).value.trim();
    if(!answerText) { alert("উত্তর লিখুন!"); return; }
    questionsRef.doc(docId).update({ answer: answerText })
      .then(() => alert("উত্তর সফলভাবে সংরক্ষিত হয়েছে!"))
      .catch(err => {
        console.error(err);
        alert("উত্তর সংরক্ষণে সমস্যা হয়েছে, আবার চেষ্টা করুন।");
      });
  }
</script>

</body>
</html>