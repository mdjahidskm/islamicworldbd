<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</title>
</head>
<body>
  <h2>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ì ‡¶â‡¶§‡ßç‡¶§‡¶∞</h2>
  <div id="questions"></div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>

  <script>
    // ‚úÖ Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyDZU9TtNXcpWW_jp366Kf2eWaN8QjigVeU",
      authDomain: "islamicworldskm.firebaseapp.com",
      projectId: "islamicworldskm",
      storageBucket: "islamicworldskm.firebasestorage.app",
      messagingSenderId: "703538391992",
      appId: "1:703538391992:web:9a36ea8c6f190fb3be3d4d"
    };

    // ‚úÖ Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ‚úÖ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
    const questionsDiv = document.getElementById("questions");

    db.collection("questions").orderBy("time", "desc").onSnapshot(snapshot => {
      questionsDiv.innerHTML = "";
      snapshot.forEach(doc => {
        const data = doc.data();
        questionsDiv.innerHTML += `
          <div style="border:1px solid gray; padding:10px; margin:10px;">
            <p><b>${data.name}</b>: ${data.question}</p>
            <p><b>‡¶â‡¶§‡ßç‡¶§‡¶∞:</b> ${data.answer || "‡¶è‡¶ñ‡¶®‡ßã ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡¶®‡¶ø"}</p>
            <textarea id="answer-${doc.id}" placeholder="‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®...">${data.answer}</textarea>
            <button onclick="saveAnswer('${doc.id}')">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
          </div>
        `;
      });
    });

    // ‚úÖ ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ
    async function saveAnswer(id) {
      const answerText = document.getElementById("answer-" + id).value;
      await db.collection("questions").doc(id).update({
        answer: answerText
      });
      alert("‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
    }
  </script>
<!-- Firebase App (core SDK) -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
<!-- Firestore SDK -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
<!-- Authentication SDK (‡¶Ø‡¶¶‡¶ø ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶π‡ßü) -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js"></script>

<script>
  // üîπ Firebase Config (‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó)
  const firebaseConfig = {
    apiKey: "AIzaSyDZU9TtNXcpWW_jp366Kf2eWaN8QjigVeU",
    authDomain: "islamicworldskm.firebaseapp.com",
    projectId: "islamicworldskm",
    storageBucket: "islamicworldskm.firebasestorage.app",
    messagingSenderId: "703538391992",
    appId: "1:703538391992:web:9a36ea8c6f190fb3be3d4d"
  };

  // üîπ Firebase Initialize
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // üîπ ‡¶Ø‡¶¶‡¶ø QA ‡¶™‡ßá‡¶ú ‡¶π‡ßü (‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ)
  if (document.getElementById("qaForm")) {
    const form = document.getElementById("qaForm");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const question = document.getElementById("question").value;

      try {
        await db.collection("questions").add({
          question: question,
          answer: "",
          createdAt: new Date()
        });
        alert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ú‡¶Æ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
        form.reset();
      } catch (error) {
        console.error("Error adding question: ", error);
      }
    });
  }

  // üîπ ‡¶Ø‡¶¶‡¶ø Admin ‡¶™‡ßá‡¶ú ‡¶π‡ßü (‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶ì ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ)
  if (document.getElementById("questionsList")) {
    const questionsList = document.getElementById("questionsList");

    async function loadQuestions() {
      const snapshot = await db.collection("questions").orderBy("createdAt", "desc").get();
      questionsList.innerHTML = "";

      snapshot.forEach(doc => {
        const data = doc.data();
        const div = document.createElement("div");
        div.innerHTML = `
          <p><b>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®:</b> ${data.question}</p>
          <p><b>‡¶â‡¶§‡ßç‡¶§‡¶∞:</b> ${data.answer || "‡¶è‡¶ñ‡¶®‡¶ì ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡¶®‡¶ø"}</p>
          <textarea id="answer-${doc.id}" placeholder="‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..."></textarea>
          <button onclick="saveAnswer('${doc.id}')">‡¶∏‡ßá‡¶≠</button>
          <hr>
        `;
        questionsList.appendChild(div);
      });
    }

    window.saveAnswer = async function(id) {
      const answer = document.getElementById("answer-" + id).value;
      await db.collection("questions").doc(id).update({
        answer: answer
      });
      alert("‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
      loadQuestions();
    };

    loadQuestions();
  }
</script>
</body>
</html>